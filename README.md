# ncRPI-LGAT

In this work, we proposed an  ncRNA-protein interactions predictor under LGNN framework by introducing graph attention mechanism.

### Dependency

Python 3.7

pytorch 1.8.1

torch-geometric 2.1.0

dependencies for node2vec

Note: This project contains node2vec released in https://github.com/aditya-grover/node2vec. So you need to configure its dependencies according to its description. But this node2vec is based on Python2, and some of its dependencies are also based on Python2. The code for node2vec included in the project was modified to make it work under Python3.

### Workflow

#### 1.Generating edgelist for node2vec

> Python .\data\_process\generate\_edgelist.py --projectName yourProjectName --interactionDatasetName NPInter2

This will output five edgelist file in 'data/graph/{yourProjectName}/training\_{0-4}/bipartite\_graph.edgelist' and five empty folder 'data/node2vec\_result/{yourProjectName}/training\_{0-4}' to store node2vec result.

##### Necessary parameters

*  --projectName : The name of dataset you want to generate.
*  --interactionName : The name of existing ncRNA-protein interaction dataset, like NPInter2, NPInter2\_lncRNA, RPI7317, and RPI2241.

##### Optional parameters

* --createBalanceDataset : Default = 1. Creating balance dataset for unbalanced interaction dataset.

#### 2. Running node2vec for each fold

> Python .\node2vec-master\src\main.py --input 'data/graph/yourProjectName/training\_{0-4}/bipartite\_graph.edgelist' --output 'data/node2vec\_result/yourProjectName/training{0-4}/result.emb'

##### Necessary parameters

*  --input : The input edgelist file generated by '.\data\_process\generate\_edgelist.py'.
*  --output : The output node2vec result. This parameter has a pattern: 'data/node2vec\_result/{yourProjectName}/result.emb'. The name of the output file must be result.emb, and the folder it in is the folder generated by '.\src\generate\_edgelist.py'

##### Optional parameters

* please see https://github.com/aditya-grover/node2vec

#### 3. Generating dataset for training

> Python .\data\_process\generate\_dataset.py --projectName yourProjectName --interactionDatasetName NPInter2 --fold 0

Note: There is randomness in the existence process because the data is shuffled as the dataset is generated.

##### Necessary parameters

* --projectName : The name of dataset you want to generate.

* --interactionName : The name of existing ncRNA-protein interaction dataset, like NPInter2, NPInter2\_lncRNA, RPI7317, and RPI2241.

* --fold : Generating dataset for which fold, 0-4

##### Optional parameters

* --createBalanceDataset : Default = 1. This parameter must keep it as same as you run src/generate\_edgelist.py

* --shuffle: Default = 1. Shuffle interactions before generate dataset, 1 means yes, 0 means no.

#### 4. Running cross validation of NPI-GNN and save models.

> Python .\src\Main.py --trainingName name of Training --DatasetName your Project Name --interactionDatasetName NPInter2 --epochNumber 100 --fold 0

This will save modules and training log in 'result/{yourProjectName}'.Every five epochs report the model performance and save the model. Please note that the paper uses the performance of the model with the largest mean MCC in a cross-validation.

Note: There is randomness in the existence process because the data is shuffled as the dataset is read.


##### Necessary parameters

* --trainingName: The name of this training.

* --datasetName: The name of dataset you want to use, and this is the same as {yourProjectName} in previous steps.

* --interactionName : The name of existing ncRNA-protein interaction dataset, like NPInter2, NPInter2\_lncRNA, RPI7317, and RPI2241.

* --fold : Which fold you want to run, 0-4.

##### Optional parameters

* --epochNumber: Default = 100. The number of epoch of each fold.

* --hopNumberï¼šDefault = 1. The hop number of h-hop local enclosing subgraph.

* --initialLearningRate: Default = 0.001. The initial learning rate of this training.

* --l2WeightDecay: Default = 0.001. The L2 weight decay of this training.

* --batchSize: Default = 32. The batch size of this training.


